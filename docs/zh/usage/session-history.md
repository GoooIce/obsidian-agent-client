# 会话历史

恢复之前的对话或从过去的会话中分支出来。

## Agent 支持

会话历史功能是 agent 特定的。并非所有 agent 都支持所有功能。

## 打开会话历史

点击聊天标题中的 **历史** 按钮（时钟图标）以打开会话历史模态框。

<p align="center">
  <img src="/images/session-history-button.webp" alt="聊天标题中的会话历史按钮" />
</p>

## 可用操作

根据 agent 的能力，你可以执行以下操作：

| 操作 | 描述 |
|------|------|
| **恢复** | 从你离开的地方继续会话 |
| **分支** | 从对话中的那个点创建新分支 |
| **删除** | 从历史记录中移除会话 |

::: tip
并非所有操作对每个 agent 都可用。模态框只显示当前 agent 支持的操作。
:::

## 会话存储

当你发送消息时会话会自动保存。插件存储：

- **会话元数据**：标题（从你的第一条消息派生）、时间戳和工作目录
- **消息历史**：包括 agent 响应、工具调用和计划的完整对话

### 会话存储位置

会话保存在两个地方：

- **插件端**：本地存储在 Obsidian 的数据文件夹中
- **Agent 端**：由 agent 管理

## 恢复 vs 分支

### 恢复

恢复会话继续现有对话：

1. Agent 重新连接到上一个会话
2. 显示你的对话历史
3. 新消息继续同一个会话

当你想**从你离开的地方继续**时使用恢复。

### 分支

分支从上一个点创建新会话：

1. 创建一个新会话，复制到该点的对话
2. 原始会话保持不变
3. 新消息进入分支会话

当你想**探索不同的方向**而不影响原始对话时使用分支。

## 删除会话

要删除会话：

1. 点击会话上的 **删除** 按钮（垃圾桶图标）
2. 在对话框中确认删除

::: warning
删除仅从插件的本地存储中移除会话。会话仍然存在于 agent 端。
:::

## 故障排除

### "此 agent 不支持会话恢复"

当前 agent 不提供会话恢复/分支功能。你仍然可以查看和删除本地保存的会话。

### "正在准备 agent..."

Agent 仍在初始化。请稍等 agent 准备就绪。

### "没有之前的会话"

当前 agent 和库还没有保存任何会话。开始新对话以创建你的第一个会话。
